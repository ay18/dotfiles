# CONFIG
# ---------------------------------------------------------------
EDITOR="code"

# Bash prompt PS1
# colors
CLR="\[$(tput sgr0)\]"
C_BLUE="$CLR\[\033[38;5;39m\]"
C_YELLOW="$CLR\[\033[38;5;228m\]"
C_RED="$CLR\[\033[38;5;203m\]"
TRI="$(echo -e '\xe2\x96\xb2')"

parse_git_branch() {
    git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/ (\1)/'
}

# git auto-complete
export LC_ALL=C
source "/usr/local/etc/bash_completion.d/git-completion.bash"

# prompt
export PS1="\n$C_BLUE\W $C_YELLOW$TRI$C_RED\$(parse_git_branch)\n> $CLR"

# nvm
export NVM_DIR="$HOME/.nvm"
. "/usr/local/opt/nvm/nvm.sh"

# aliases

alias reload='. ~/.bashrc'
alias bashrc='$EDITOR ~/.bashrc'
alias dotfiles='cd ~/dev/config/dotfiles'

alias sshvm='ssh -t cyee@10.228.191.43 bash -l'
alias wfcode='cd ~/codebase'
alias wfres='cd ~/codebase/resources'
alias wfphp='cd ~/codebase/php'

alias dev='cd ~/dev'
alias sb='cd ~/dev/sandbox'
alias lab='cd ~/dev/lab'

# automating commands

wfsync() {
  realsync ~/codebase
}

wfdebug() {
  . ~/dev/config/remote_debug.sh >/dev/null
}

wms_docker_up() {
  cd ~/docker-sql-server && docker-compose -p dev up
}

wfstart() {
  (
    cd ~/dev/; tmux new-session -d -s wfdev -n window
    for _ in {1..3}
      do
        tmux send-keys -t wfdev:window 'tmux split-window -h' Enter
    done
    tmux send-keys -t wfdev:window 'tmux select-layout even-horizontal' Enter
    tmux send-keys -t wfdev:window 'tmux send-keys -t 0.1 "wfsync" Enter' Enter 
    tmux send-keys -t wfdev:window 'tmux send-keys -t 0.2 "wfdebug" Enter' Enter
    tmux send-keys -t wfdev:window 'tmux send-keys -t 0.3 "wms_docker_up" Enter' Enter
    tmux send-keys -t wfdev:window 'tmux select-pane -t 0.0' Enter
    tmux attach -t wfdev:window
  )
}

wfend() {
  tmux kill-server
}
